Querry untuk menjawab pertanyaan analisa berikut ini:

-- Cari 5 pelanggan dengan jumlah transaksi tertinggi sepanjang masa. Sertakan nama pelanggan, total transaksi, dan rata-rata nilai transaksi mereka.

-- Untuk setiap kategori film, hitung total pendapatan yang dihasilkan, rata-rata durasi film, total transaksi, dan jumlah pelanggan. Urutkan kategori berdasarkan total pendapatan tertinggi.

-- Temukan jam berapa (dalam 24 jam) rental paling sering dilakukan. Tampilkan jam dan jumlah transaksi yang dilakukan pada jam tersebut.

-- Hitung persentase pelanggan aktif (pelanggan yang melakukan setidaknya 1 transaksi) dibandingkan dengan total pelanggan dalam database.

-- Berapa persentase film di inventaris yang pernah dirental setidaknya satu kali? Sertakan jumlah film yang pernah dirental dan total film di inventaris.

-- Cari 5 kota dengan pendapatan rental tertinggi. Tampilkan nama kota, negara, dan total pendapatan rental dari setiap kota.

-- Analisis rata-rata durasi keterlambatan pengembalian sewa film dan Customer yang paling sering melakukan keterlambatan pengembalian

-- Hitung rata-rata jumlah transaksi per pelanggan untuk setiap negara. Urutkan negara berdasarkan rata-rata transaksi per pelanggan, dari yang tertinggi ke terendah.

-- Untuk setiap staf, hitung total pendapatan rental yang dihasilkan. Urutkan staf berdasarkan total pendapatan dari transaksi yang mereka proses.

-- Analisis tren popularitas sebuah film berdasarkan jumlah rental-nya per bulan.Tampilkan hasil untuk salah satu film dengan jumlah rental tertinggi.

-- Top 5 Film yang paling banyak disewa setiap bulan, berdasarkan jumlah penyewaan.


Latihan select statement, join, window function, virtual table, CTE dan subquerry, dll
